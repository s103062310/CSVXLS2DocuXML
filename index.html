<!DOCTYPE html>
<html>

<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8;"/>
	<link rel="icon" href="images/docusky_icon.png">
	<title>CSV/XLS to DocuXML Converter</title>

	<!-- ASSETS -->
	<script src="assets/jquery.min.js"></script>
	<script src="https://oss.sheetjs.com/sheetjs/xlsx.full.min.js"></script>

	<!-- CSS FILE -->
	<link href="css/main-style.css" type="text/css" rel="stylesheet">
	<link href="css/animating-style.css" type="text/css" rel="stylesheet">
	<link href="css/IO-style.css" type="text/css" rel="stylesheet">
	<link href="css/setting-style.css" type="text/css" rel="stylesheet">
	<link href="css/content-style.css" type="text/css" rel="stylesheet">
	<link href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet">
	<script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>

	<!-- DOCUSKY WIDGET API: https://docusky.org.tw/Docusky v.s. ../.. -->
	<script src="https://docusky.org.tw/Docusky/js/jquery.min.js"></script>
	<script src="https://docusky.org.tw/Docusky/js/jquery-ui.min.js"></script>
	<script src="https://docusky.org.tw/Docusky/js.ui/docusky.ui.manageDbListSimpleUI.js"></script>
</head>

<body>

	<!-- usage explain -->
	<div id="explainText" style="display: none;"></div>

	<!-- light box -->
	<div id="lightbox">
		<div id="lightbox-bg">
			<div id="lightbox-content">
				<div id="lightbox-filename"><h1 class="text-center">Sheet Name</h1></div>
				<div id="lightbox-close"><span class="glyphicon glyphicon-remove text-center"></span></div>
				<div id="lightbox-text"></div>
			</div>
		</div>
	</div>

	<!-- tool bar -->
	<div id="toolbar">
		<span id="usage" class="glyphicon glyphicon-question-sign">
			<span class="tooltip-box">
				<span class="arrow-t"></span>
				<span class="tooltip-text">使用說明</span>
			</span>
		</span>
		<span id="mydb" class="glyphicon glyphicon-cloud" onclick="window.open('https://docusky.org.tw/DocuSky/docuTools/userMain/')">
			<span class="tooltip-box">
				<span class="arrow-t"></span>
				<span class="tooltip-text">我的資料庫</span>
			</span>
		</span>
		<span id="docusky" class="glyphicon glyphicon-home" onclick="window.open('https://docusky.org.tw/DocuSky/ds-01.home.html')">
			<span class="tooltip-box">
				<span class="arrow-t"></span>
				<span class="tooltip-text">回首頁</span>
			</span>
		</span>
	</div>

	<!-- tool content -->
	<div id="topContainer">

		<!-- page btn -->
		<span id="prevPage" class="glyphicon glyphicon-chevron-left"></span>
		<span id="nextPage" class="glyphicon glyphicon-chevron-right"></span>

		<!-- header -->
		<div id="toolName">
			<h1 class="text-center">CSV/Excel to DocuXML 格式轉換工具</h1>
			<hr>

			<!-- page setting -->
			<div id="progressBar">
				<div id="upload" class="text-center target"><span class="circle"></span></div>
				<div id="upload-required"></div>
				<div id="required" class="text-center"><span>2</span></div>
				<div id="required-optional"></div>
				<div id="optional" class="text-center"><span>3</span></div>
				<div id="optional-custom"></div>
				<div id="custom" class="text-center"><span>4</span></div>
				<div id="custom-content"></div>
				<div id="content" class="text-center"><span>5</span></div>
				<div id="content-download"></div>
				<div id="download" class="text-center"><span>6</span></div>
			</div>
		</div>

		<!-- tool -->
		<div id="toolWrapper">

			<!-- step 1: -->
			<div id="uploadInterface" class="panelWrapper current">
				
				<div class="explainPanel bg-warning">
					<h2 class="text-center">Step 1: 上傳 CSV/Excel 檔案</h2>
					<div>
						<ul>
							<li>此工具接受 <b class="text-info">.csv, .xls, .xlsx</b> 格式之檔案。</li>
							<li>請用 <b class="text-danger">UTF-8</b> 編碼格式儲存檔案，以避免出現亂碼。</li>
							<li>若輸入含有<b class="text-info">合併儲存格</b>的檔案，除了第一個儲存格外，其他合併之儲存格將會是<b class="text-danger">空白</b>。</li>
						</ul>
					</div>
					<img src="images/progress.gif" style="display: none; margin: 0 30%; width: 40%;">
				</div>

				<div id="uploadToolBar">
					<button id="selectAll" type="button" class="btn btn-default">全選</button>
					<button id="selectReverse" type="button" class="btn btn-default">反向選取</button>
					<button id="deleteAll" type="button" class="btn btn-default">全部刪除</button>
					<button id="deleteSelect" type="button" class="btn btn-default">將選取者刪除</button>
				</div>

				<div id="fileManager" class="contentPanel">
					<label class="uploadCover emptyCover">
						<input id="uploadInput" type="file" name="uploadInput" accept=".csv, .xls, .xlsx" multiple/>
						<span class="glyphicon glyphicon-cloud-upload"></span>
						<span class="coverText">新增檔案</span>
					</label>
				</div>
				
			</div>

			<!-- step 2 -->
			<div id="requiredInterface" class="panelWrapper">
				
				<div class="explainPanel bg-warning">
					<h2 class="text-center">Step 2: 詮釋資料<b class="text-danger">必填</b>欄位對應設定（選 EXCEL 欄位）</h2>
					<div>
						<ul>
							<li>每份文件必具備所屬的<b class="text-info">文獻集名稱</b>、<b class="text-info">唯一編號</b>。</li>
							<li>請確實填寫本頁再繼續。</li>
							<li>此頁送出後<b class="text-danger">不可更改</b>，請確認後再移往下一步驟。</li>
							<li>按下一步進行後續設定，若檔案數量眾多，需稍等候。</li>
						</ul>
					</div>
					<img src="images/progress.gif" style="display: none; margin: 0 30%; width: 40%;">
				</div>

				<div class="contentPanel multisetting">

					<div class="tableList">
						<ul class="list-group text-center"></ul>
					</div>

					<div class="settingPanel"></div>

				</div>
				
			</div>

			<!-- step 3 -->
			<div id="optionalInterface" class="panelWrapper">

				<div class="explainPanel bg-warning">
					<h2 class="text-center">Step 3: 詮釋資料<b class="text-danger">選填</b>欄位對應設定（選系統預設欄位）</h2>
					<div>
						<ul>
							<li>詮釋資料系統預設欄位詳細說明請見 <a href="https://docs.google.com/spreadsheets/d/1G7UPZv-G1D7Yowwj_r7pO7rZXmr16PrxEZQ22_bqFIw/edit#gid=0" target="_blank">Metadata 規範表</a>。</li>
							<li>每個系統預設欄位只能被選擇一次。</li>
						</ul>
					</div>
				</div>

				<div class="contentPanel multisetting">
					
					<div class="tableList">
						<ul class="list-group text-center"></ul>
					</div>

					<div class="settingPanel"></div>

				</div>
				
			</div>

			<!-- step 4 -->
			<div id="customInterface" class="panelWrapper">

				<div class="explainPanel bg-warning">
					<h2 class="text-center">Step 4: 自訂詮釋資料</h2>
					<div>
						<ul>
							<li>若想讓 Metadata 在建庫後可以出現在 <b class="text-info">DocMeta</b> 裡，需在此以「新增一項自訂欄位」的方式再對應一次。</li>
							<li>欄位名稱請以<b class="text-danger">半形英文</b>設定。</li>
							<li><b>「欄位名稱」</b>與<b>「欄位資料」</b>為<b class="text-danger">必填</b>，「超連結資料」為選填。</li>
						</ul>
					</div>
				</div>

				<div class="contentPanel multisetting">
					
					<div class="tableList">
						<ul class="list-group text-center"></ul>
					</div>

					<div class="settingPanel"></div>

				</div>
				
			</div>

			<!-- step 5 -->
			<div id="contentInterface" class="panelWrapper">

				<div class="explainPanel bg-warning">
					<h2 class="text-center">Step 5: 添加文件內文</h2>
					<div>
						<ul>
							<li>額外上傳之文件檔案，請用 <b class="text-info">.txt</b> 純文字檔，並以 <b class="text-danger">UTF-8</b> 編碼格式儲存檔案，避免出現亂碼。</li>
							<li>此步驟僅將所提供之文檔併入 XML 中，內文、多值欄位、註解、事件之編寫，欄位內容需符合 <a href="https://docusky.org.tw/DocuSky/documentation/docs/DocuXml-1.2-Scheme.html#%E5%85%A7%E6%96%87XML" target="_blank">DocuXML</a> 標準。</li>
							<li>按下一步即開始轉換，若檔案較大，需稍等候。</li>
						</ul>
					</div>
					<img src="images/progress.gif" style="display: none; margin: 0 30%; width: 40%;">
				</div>

				<div class="contentPanel multisetting">

					<div class="tableList">
						<ul class="list-group text-center"></ul>
					</div>

					<div class="settingPanel">
						<div class="txtFilesHeader fixed">
							<span>檔名</span>
							<span>狀態</span>
							<span>檢視</span>
							<span>操作</span>
						</div>
						<input id="singleTXT" type="file" accept=".txt" onchange="uploadSingleTXT(this, true)" style="display: none;"/>
						<input id="multiTXT" type="file" accept=".txt" onchange="uploadMultiTXT(this)" style="display: none;" multiple/>
						<input id="wholeTXT" type="file" accept=".txt" onchange="uploadWholeTXT(this)" style="display: none;"/>
					</div>

				</div>
				
			</div>

			<!-- step 6 -->
			<div id="downloadInterface" class="panelWrapper">

				<div class="explainPanel bg-warning">
					<h2 class="text-center">Step 6: 輸出 DocuXML 檔案</h2>
					<div>
						<ul>
							<li><b class="text-danger">請記得下載一份檔案到本地端做備份。</b></li>
						</ul>
					</div>
				</div>

				<div class="contentPanel">
					
					<div id="ouputFilename" class="input">
						<h3>輸出檔案名稱</h3>
						<input type="text" name="ouputFilename" value="我的文獻集">
						<button type="button" class="btn btn-default">下載</button>
					</div>

					<div id="databaseName" class="input">
						<h3>資料庫名稱</h3>
						<input type="text" name="databaseName">
						<button type="button" class="btn btn-default">建庫到 DocuSky 上</button>
					</div>

		            <div class="progress" style="height: 5%; margin: 1%; display: none;">
						<div class="progress-bar progress-bar-info" role="progressbar" style="width: 0%; display: grid; align-items: center;">
							<span style="font-size: medium;">0 %</span>
						</div>
					</div>

					<div>
						<h3>接續使用</h3>
						<ul style="font-size: medium;">
							<li><a href="https://docusky.org.tw/DocuSky/docuTools/userMain/" target="_blank">線上資料庫</a>：建構、刪除、檢視、檢索資料庫。</li>
							<li><a href="https://docusky.org.tw/DocuSky/docuTools/RecomposeXML/manageMetadataFieldsTool.html" target="_blank">建庫檔管理工具</a>：<b class="text-danger">後分類的設定</b>。</li>
							<li><a href="https://docusky.org.tw/DocuSky/docuTools/TermClipper/TermClipper2020.html" target="_blank">擷詞工具</a>：文本探勘，從文本擷取出詞彙清單。</li>
							<li><a href="https://docusky.org.tw/DocuSky/docuTools/ContentTaggingTool/" target="_blank">內容標記工具</a>：文本標記，對文本進行人名、地名、職官、時間等標註。</li>
							<li><a href="https://docusky.org.tw/DocuSky/docuTools/TagStatsTool/index.html" target="_blank">標記與詞彙統計分析工具</a>：文本分析，統計文本的詞彙與標記。</li>
						</ul>
					</div>

					<div class="output">
						<h3>XML 預覽</h3>
						<div id="XMLoutput" class="text-muted"></div>
					</div>

				</div>
				
			</div>
			
		</div>

	</div>

	<!-- JAVASCRIPT FILE -->
	<script src="js/globalVar.js"></script>
	<script src="js/fileLoading.js"></script>
	<script src="js/dataProcess.js"></script>
	<script src="js/display.js"></script>
	<script src="js/interaction.js"></script>
	
</body>

</html>